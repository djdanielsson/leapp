---
# tasks file for analysis
- name: Ensure leapp metadata is available for disconnected Leapp upgrades
  when: leapp_upgrade_type == 'disconnected'
  block:
    - name: /etc/leapp/files directory exists
      ansible.builtin.file:
        path: /etc/leapp/files
        state: directory
        owner: root
        group: root
        mode: '0755'

    - name: Leapp utility metadata is installed
      ansible.builtin.unarchive:
        src: "{{ leapp_metadata_url }}"
        dest: /etc/leapp/files
        remote_src: true
        owner: root
        group: root

# TODO: Include tasks for RHEL 6 to 7 non-leapp upgrade
# - name: Include tasks for preupg assistant analysis
#   ansible.builtin.include_tasks: analysis-preupg.yml
#   when: ansible_distribution_major_version|int < 7

- name: Include tasks for leapp preupgrade analysis
  ansible.builtin.include_tasks: analysis-leapp.yml
  when: ansible_distribution_major_version|int >= 7
...
